Problem 1: Customer Sales Analysis
Analyze the sales performance of customers by calculating the total sales amount and average order value for each customer. List the customer name, total sales amount, and average order value in descending order of total sales amount.

SELECT c.customerName, SUM(od.priceEach * od.quantityOrdered) AS totalSalesAmount, AVG(od.priceEach * od.quantityOrdered) AS averageOrderValue
FROM customers AS c
JOIN orders AS o ON c.customerNumber = o.customerNumber
JOIN orderdetails AS od ON o.orderNumber = od.orderNumber
GROUP BY c.customerNumber, c.customerName
ORDER BY totalSalesAmount DESC;

Problem 2: Product Inventory Analysis
Perform an analysis of the product inventory by calculating the total quantity in stock and the total value of each product line. List the product line, total quantity in stock, and total value in descending order of total value.

SELECT pl.productLine, SUM(p.quantityInStock) AS totalQuantityInStock, SUM(p.quantityInStock * p.buyPrice) AS totalValue
FROM products AS p
JOIN productlines AS pl ON p.productLine = pl.productLine
GROUP BY pl.productLine
ORDER BY totalValue DESC;

Problem 3: Employee Performance Analysis
Analyze the performance of employees by calculating the total sales amount generated by each employee. List the employee name, total sales amount, and their respective managers in descending order of total sales amount.

SELECT CONCAT(e.firstName, ' ', e.lastName) AS employeeName, SUM(od.priceEach * od.quantityOrdered) AS totalSalesAmount, CONCAT(m.firstName, ' ', m.lastName) AS managerName
FROM employees AS e
JOIN employees AS m ON e.reportsTo = m.employeeNumber
JOIN customers AS c ON e.employeeNumber = c.salesRepEmployeeNumber
JOIN orders AS o ON c.customerNumber = o.customerNumber
JOIN orderdetails AS od ON o.orderNumber = od.orderNumber
GROUP BY e.employeeNumber, employeeName, managerName
ORDER BY totalSalesAmount DESC;
